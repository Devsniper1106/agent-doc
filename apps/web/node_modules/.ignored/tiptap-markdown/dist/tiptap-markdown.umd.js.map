{"version":3,"file":"tiptap-markdown.umd.js","sources":["../src/extensions/tiptap/tight-lists.js","../src/util/markdown.js","../src/serialize/state.js","../src/extensions/marks/html.js","../src/util/dom.js","../src/extensions/nodes/html.js","../src/extensions/nodes/blockquote.js","../src/extensions/nodes/bullet-list.js","../src/extensions/nodes/code-block.js","../src/extensions/nodes/hard-break.js","../src/extensions/nodes/heading.js","../src/extensions/nodes/horizontal-rule.js","../src/extensions/nodes/image.js","../src/extensions/nodes/list-item.js","../src/extensions/nodes/ordered-list.js","../src/extensions/nodes/paragraph.js","../src/util/prosemirror.js","../src/extensions/nodes/table.js","../src/extensions/nodes/task-item.js","../src/extensions/nodes/task-list.js","../src/extensions/nodes/text.js","../src/extensions/marks/bold.js","../src/extensions/marks/code.js","../src/extensions/marks/italic.js","../src/extensions/marks/link.js","../src/extensions/marks/strike.js","../src/extensions/index.js","../src/util/extensions.js","../src/serialize/MarkdownSerializer.js","../src/parse/MarkdownParser.js","../src/extensions/tiptap/clipboard.js","../src/Markdown.js"],"sourcesContent":["import { Extension } from \"@tiptap/core\";\n\nexport const MarkdownTightLists = Extension.create({\n    name: 'markdownTightLists',\n    addOptions: () => ({\n        tight: true,\n        tightClass: 'tight',\n        listTypes: [\n            'bulletList',\n            'orderedList',\n        ],\n    }),\n    addGlobalAttributes() {\n        return [\n            {\n                types: this.options.listTypes,\n                attributes: {\n                    tight: {\n                        default: this.options.tight,\n                        parseHTML: element =>\n                            element.getAttribute('data-tight') === 'true' || !element.querySelector('p'),\n                        renderHTML: attributes => ({\n                            class: attributes.tight ? this.options.tightClass : null,\n                            'data-tight': attributes.tight ? 'true' : null,\n                        }),\n                    },\n                },\n            },\n        ]\n    },\n    addCommands() {\n        return {\n            toggleTight: (tight = null) => ({ editor, commands }) => {\n                function toggleTight(name) {\n                    if(!editor.isActive(name)) {\n                        return false;\n                    }\n                    const attrs = editor.getAttributes(name);\n                    return commands.updateAttributes(name, {\n                        tight: tight ?? !attrs?.tight,\n                    });\n                }\n                return this.options.listTypes\n                    .some(name => toggleTight(name));\n            }\n        }\n    },\n});\n","import markdownit from 'markdown-it';\n\n\nfunction scanDelims(text, pos) {\n    const state = new (markdownit().inline.State)(text, null, null, []);\n    return state.scanDelims(pos, true);\n}\n\nexport function shiftDelim(text, delim, start, offset) {\n    let res = text.substring(0, start) + text.substring(start + delim.length);\n    res = res.substring(0, start + offset) + delim + res.substring(start + offset);\n    return res;\n}\n\nfunction trimStart(text, delim, from, to) {\n    let pos = from, res = text;\n    while(pos < to) {\n        if(scanDelims(res, pos).can_open) {\n            break;\n        }\n        res = shiftDelim(res, delim, pos, 1);\n        pos++;\n    }\n    return { text: res, from: pos, to }\n}\n\nfunction trimEnd(text, delim, from, to) {\n    let pos = to, res = text;\n    while(pos > from) {\n        if(scanDelims(res, pos).can_close) {\n            break;\n        }\n        res = shiftDelim(res, delim, pos, -1);\n        pos--;\n    }\n    return { text: res, from, to: pos }\n}\n\nexport function trimInline(text, delim, from, to) {\n    let state = {\n        text,\n        from,\n        to,\n    }\n\n    state = trimStart(state.text, delim, state.from, state.to);\n    state = trimEnd(state.text, delim, state.from, state.to);\n\n    if(state.to - state.from < delim.length + 1) {\n        state.text = state.text.substring(0, state.from) + state.text.substring(state.to + delim.length);\n    }\n\n    return state.text;\n}\n","import { MarkdownSerializerState as BaseMarkdownSerializerState } from \"prosemirror-markdown\";\nimport { trimInline } from \"../util/markdown\";\n\n\n/**\n * Override default MarkdownSerializerState to:\n * - handle commonmark delimiters (https://spec.commonmark.org/0.29/#left-flanking-delimiter-run)\n */\nexport class MarkdownSerializerState extends BaseMarkdownSerializerState {\n\n    constructor(nodes, marks, options) {\n        super(nodes, marks, options ?? {});\n        this.inlines = [];\n    }\n\n    render(node, parent, index) {\n        super.render(node, parent, index);\n        const top = this.inlines[this.inlines.length - 1];\n        if(top?.start && top?.end) {\n            const { delimiter, start, end } = this.normalizeInline(top);\n            this.out = trimInline(this.out, delimiter, start, end);\n            this.inlines.pop();\n        }\n    }\n\n    markString(mark, open, parent, index) {\n        const info = this.marks[mark.type.name]\n        if(info.expelEnclosingWhitespace) {\n            if(open) {\n                this.inlines.push({\n                    start: this.out.length,\n                    delimiter: info.open,\n                });\n            } else {\n                const top = this.inlines.pop();\n                this.inlines.push({\n                    ...top,\n                    end: this.out.length,\n                });\n            }\n        }\n        return super.markString(mark, open, parent, index);\n    }\n\n    normalizeInline(inline) {\n        let { start, end } = inline;\n        while(this.out.charAt(start).match(/\\s/)) {\n            start++;\n        }\n        return {\n            ...inline,\n            start,\n        }\n    }\n}\n","import { Fragment } from \"@tiptap/pm/model\";\nimport { getHTMLFromFragment, Mark } from \"@tiptap/core\";\n\n\nexport default Mark.create({\n    name: 'markdownHTMLMark',\n    /**\n     * @return {{markdown: MarkdownMarkSpec}}\n     */\n    addStorage() {\n        return {\n            markdown: {\n                serialize: {\n                    open(state, mark)  {\n                        if(!this.editor.storage.markdown.options.html) {\n                            console.warn(`Tiptap Markdown: \"${mark.type.name}\" mark is only available in html mode`);\n                            return '';\n                        }\n                        return getMarkTags(mark)?.[0] ?? '';\n                    },\n                    close(state, mark) {\n                        if(!this.editor.storage.markdown.options.html) {\n                            return '';\n                        }\n                        return getMarkTags(mark)?.[1] ?? '';\n                    },\n                },\n                parse: {\n                    // handled by markdown-it\n                }\n            }\n        }\n    }\n});\n\nfunction getMarkTags(mark) {\n    const schema = mark.type.schema;\n    const node = schema.text(' ', [mark]);\n    const html = getHTMLFromFragment(Fragment.from(node), schema);\n    const match = html.match(/^(<.*?>) (<\\/.*?>)$/);\n    return match ? [match[1], match[2]] : null;\n}\n","\n\nexport function elementFromString(value) {\n    // add a wrapper to preserve leading and trailing whitespace\n    const wrappedValue = `<body>${value}</body>`\n\n    return new window.DOMParser().parseFromString(wrappedValue, 'text/html').body\n}\n\nexport function escapeHTML(value) {\n    return value\n        ?.replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;');\n}\n\nexport function extractElement(node) {\n    const parent = node.parentElement;\n    const prepend = parent.cloneNode();\n\n    while(parent.firstChild && parent.firstChild !== node) {\n        prepend.appendChild(parent.firstChild);\n    }\n\n    if(prepend.childNodes.length > 0) {\n        parent.parentElement.insertBefore(prepend, parent);\n    }\n    parent.parentElement.insertBefore(node, parent);\n    if(parent.childNodes.length === 0) {\n        parent.remove();\n    }\n}\n\nexport function unwrapElement(node) {\n    const parent = node.parentNode;\n\n    while (node.firstChild) parent.insertBefore(node.firstChild, node);\n\n    parent.removeChild(node);\n}\n","import { Fragment } from \"@tiptap/pm/model\";\nimport { getHTMLFromFragment, Node } from \"@tiptap/core\";\nimport { elementFromString } from \"../../util/dom\";\n\n\nexport default Node.create({\n    name: 'markdownHTMLNode',\n    addStorage() {\n        return {\n            markdown: {\n                serialize(state, node, parent) {\n                    if(this.editor.storage.markdown.options.html) {\n                        state.write(serializeHTML(node, parent));\n                    } else {\n                        console.warn(`Tiptap Markdown: \"${node.type.name}\" node is only available in html mode`);\n                        state.write(`[${node.type.name}]`);\n                    }\n                    if(node.isBlock) {\n                        state.closeBlock(node);\n                    }\n                },\n                parse: {\n                    // handled by markdown-it\n                },\n            },\n        }\n    }\n});\n\nfunction serializeHTML(node, parent) {\n    const schema = node.type.schema;\n    const html = getHTMLFromFragment(Fragment.from(node), schema);\n\n    if(node.isBlock && parent.type.name === schema.topNodeType.name) {\n        return formatBlock(html);\n    }\n\n    return html;\n}\n\n/**\n * format html block as per the commonmark spec\n */\nfunction formatBlock(html) {\n    const dom = elementFromString(html);\n    const element = dom.firstElementChild;\n\n    element.innerHTML = element.innerHTML.trim()\n        ? `\\n${element.innerHTML}\\n`\n        : `\\n`;\n\n    return element.outerHTML;\n}\n","import { Node } from \"@tiptap/core\";\nimport { defaultMarkdownSerializer } from \"prosemirror-markdown\";\n\n\nconst Blockquote = Node.create({\n    name: 'blockquote',\n});\n\nexport default Blockquote.extend({\n    /**\n     * @return {{markdown: MarkdownNodeSpec}}\n     */\n    addStorage() {\n        return {\n            markdown: {\n                serialize: defaultMarkdownSerializer.nodes.blockquote,\n                parse: {\n                    // handled by markdown-it\n                },\n            }\n        }\n    }\n});\n","import { Node } from \"@tiptap/core\";\n\n\nconst BulletList = Node.create({\n    name: 'bulletList',\n});\n\nexport default BulletList.extend({\n    /**\n     * @return {{markdown: MarkdownNodeSpec}}\n     */\n    addStorage() {\n        return {\n            markdown: {\n                serialize(state, node) {\n                    return state.renderList(node, \"  \", () => (this.editor.storage.markdown.options.bulletListMarker || \"-\") + \" \");\n                },\n                parse: {\n                    // handled by markdown-it\n                },\n            }\n        }\n    }\n});\n","import { Node } from \"@tiptap/core\";\n\n\nconst CodeBlock = Node.create({\n    name: 'codeBlock',\n});\n\nexport default CodeBlock.extend({\n    /**\n     * @return {{markdown: MarkdownNodeSpec}}\n     */\n    addStorage() {\n        return {\n            markdown: {\n                serialize(state, node) {\n                    state.write(\"```\" + (node.attrs.language || \"\") + \"\\n\");\n                    state.text(node.textContent, false);\n                    state.ensureNewLine();\n                    state.write(\"```\");\n                    state.closeBlock(node);\n                },\n                parse: {\n                    setup(markdownit) {\n                        markdownit.set({\n                            langPrefix: this.options.languageClassPrefix ?? 'language-',\n                        });\n                    },\n                    updateDOM(element) {\n                        element.innerHTML = element.innerHTML.replace(/\\n<\\/code><\\/pre>/g, '</code></pre>')\n                    },\n                },\n            }\n        }\n    }\n});\n","import { Node } from \"@tiptap/core\";\nimport { defaultMarkdownSerializer } from \"prosemirror-markdown\";\n\n\nconst HardBreak = Node.create({\n    name: 'hardBreak',\n});\n\nexport default HardBreak.extend({\n    /**\n     * @return {{markdown: MarkdownNodeSpec}}\n     */\n    addStorage() {\n        return {\n            markdown: {\n                serialize: defaultMarkdownSerializer.nodes.hard_break,\n                parse: {\n                    // handled by markdown-it\n                },\n            }\n        }\n    }\n});\n","import { Node } from \"@tiptap/core\";\nimport { defaultMarkdownSerializer } from \"prosemirror-markdown\";\n\n\nconst Heading = Node.create({\n    name: 'heading',\n});\n\nexport default Heading.extend({\n    /**\n     * @return {{markdown: MarkdownNodeSpec}}\n     */\n    addStorage() {\n        return {\n            markdown: {\n                serialize: defaultMarkdownSerializer.nodes.heading,\n                parse: {\n                    // handled by markdown-it\n                },\n            }\n        }\n    }\n});\n","import { Node } from \"@tiptap/core\";\nimport { defaultMarkdownSerializer } from \"prosemirror-markdown\";\n\n\nconst HorizontalRule = Node.create({\n    name: 'horizontalRule',\n});\n\nexport default HorizontalRule.extend({\n    /**\n     * @return {{markdown: MarkdownNodeSpec}}\n     */\n    addStorage() {\n        return {\n            markdown: {\n                serialize: defaultMarkdownSerializer.nodes.horizontal_rule,\n                parse: {\n                    // handled by markdown-it\n                },\n            }\n        }\n    }\n});\n","import { Node } from \"@tiptap/core\";\nimport { defaultMarkdownSerializer } from \"prosemirror-markdown\";\n\n\nconst Image = Node.create({\n    name: 'image',\n});\n\nexport default Image.extend({\n    /**\n     * @return {{markdown: MarkdownNodeSpec}}\n     */\n    addStorage() {\n        return {\n            markdown: {\n                serialize: defaultMarkdownSerializer.nodes.image,\n                parse: {\n                    // handled by markdown-it\n                },\n            }\n        }\n    }\n});\n","import { Node } from \"@tiptap/core\";\nimport { defaultMarkdownSerializer } from \"prosemirror-markdown\";\n\n\nconst ListItem = Node.create({\n    name: 'listItem',\n});\n\nexport default ListItem.extend({\n    /**\n     * @return {{markdown: MarkdownNodeSpec}}\n     */\n    addStorage() {\n        return {\n            markdown: {\n                serialize: defaultMarkdownSerializer.nodes.list_item,\n                parse: {\n                    // handled by markdown-it\n                },\n            }\n        }\n    }\n});\n","import { Node } from \"@tiptap/core\";\nimport { defaultMarkdownSerializer } from \"prosemirror-markdown\";\n\n\nconst OrderedList = Node.create({\n    name: 'orderedList',\n});\n\nexport default OrderedList.extend({\n    /**\n     * @return {{markdown: MarkdownNodeSpec}}\n     */\n    addStorage() {\n        return {\n            markdown: {\n                serialize: defaultMarkdownSerializer.nodes.ordered_list,\n                parse: {\n                    // handled by markdown-it\n                },\n            }\n        }\n    }\n});\n","import { Node } from \"@tiptap/core\";\nimport { defaultMarkdownSerializer } from \"prosemirror-markdown\";\n\n\nconst Paragraph = Node.create({\n    name: 'paragraph',\n});\n\nexport default Paragraph.extend({\n    /**\n     * @return {{markdown: MarkdownNodeSpec}}\n     */\n    addStorage() {\n        return {\n            markdown: {\n                serialize: defaultMarkdownSerializer.nodes.paragraph,\n                parse: {\n                    // handled by markdown-it\n                },\n            },\n        }\n    }\n});\n","\n\nexport function childNodes(node) {\n    return node?.content?.content ?? [];\n}\n","import { Node } from \"@tiptap/core\";\nimport { childNodes } from \"../../util/prosemirror\";\nimport HTMLNode from './html';\n\nconst Table = Node.create({\n    name: 'table',\n});\n\nexport default Table.extend({\n    /**\n     * @return {{markdown: MarkdownNodeSpec}}\n     */\n    addStorage() {\n        return {\n            markdown: {\n                serialize(state, node, parent) {\n                    if(!isMarkdownSerializable(node)) {\n                        HTMLNode.storage.markdown.serialize.call(this, state, node, parent);\n                        return;\n                    }\n                    node.forEach((row, p, i) => {\n                        state.write('| ');\n                        row.forEach((col, p, j) => {\n                            if(j) {\n                                state.write(' | ');\n                            }\n                            const cellContent = col.firstChild;\n                            if(cellContent.textContent.trim()) {\n                                state.renderInline(cellContent);\n                            }\n                        });\n                        state.write(' |')\n                        state.ensureNewLine();\n                        if(!i) {\n                            const delimiterRow = Array.from({length: row.childCount}).map(() => '---').join(' | ');\n                            state.write(`| ${delimiterRow} |`);\n                            state.ensureNewLine();\n                        }\n                    });\n                    state.closeBlock(node);\n                },\n                parse: {\n                    // handled by markdown-it\n                },\n            }\n        }\n    }\n})\n\n\nfunction hasSpan(node) {\n    return node.attrs.colspan > 1 || node.attrs.rowspan > 1;\n}\n\nfunction isMarkdownSerializable(node) {\n    const rows = childNodes(node);\n    const firstRow = rows[0];\n    const bodyRows = rows.slice(1);\n\n    if(childNodes(firstRow).some(cell => cell.type.name !== 'tableHeader' || hasSpan(cell))) {\n        return false;\n    }\n\n    if(bodyRows.some(row =>\n        childNodes(row).some(cell => cell.type.name === 'tableHeader' || hasSpan(cell))\n    )) {\n        return false;\n    }\n\n    return true;\n}\n","import { Node } from \"@tiptap/core\";\n\n\nconst TaskItem = Node.create({\n    name: 'taskItem',\n});\n\nexport default TaskItem.extend({\n    /**\n     * @return {{markdown: MarkdownNodeSpec}}\n     */\n    addStorage() {\n        return {\n            markdown: {\n                serialize(state, node) {\n                    const check = node.attrs.checked ? '[x]' : '[ ]';\n                    state.write(`${check} `);\n                    state.renderContent(node);\n                },\n                parse: {\n                    updateDOM(element) {\n                        [...element.querySelectorAll('.task-list-item')]\n                            .forEach(item => {\n                                const input = item.querySelector('input');\n                                item.setAttribute('data-type', 'taskItem');\n                                if(input) {\n                                    item.setAttribute('data-checked', input.checked);\n                                    input.remove();\n                                }\n                            });\n                    },\n                }\n            }\n        }\n    }\n});\n","import taskListPlugin from \"markdown-it-task-lists\";\nimport { Node } from \"@tiptap/core\";\nimport BulletList from \"./bullet-list\";\n\n\nconst TaskList = Node.create({\n    name: 'taskList',\n});\n\nexport default TaskList.extend({\n    /**\n     * @return {{markdown: MarkdownNodeSpec}}\n     */\n    addStorage() {\n        return {\n            markdown: {\n                serialize: BulletList.storage.markdown.serialize,\n                parse: {\n                    setup(markdownit) {\n                        markdownit.use(taskListPlugin);\n                    },\n                    updateDOM(element) {\n                        [...element.querySelectorAll('.contains-task-list')]\n                            .forEach(list => {\n                                list.setAttribute('data-type', 'taskList');\n                            });\n                    },\n                }\n            }\n        }\n    }\n});\n","import { Node } from \"@tiptap/core\";\nimport { escapeHTML } from \"../../util/dom\";\n\n\nconst Text = Node.create({\n    name: 'text',\n});\n\nexport default Text.extend({\n    /**\n     * @return {{markdown: MarkdownNodeSpec}}\n     */\n    addStorage() {\n        return {\n            markdown: {\n                serialize(state, node) {\n                    state.text(escapeHTML(node.text));\n                },\n                parse: {\n                    // handled by markdown-it\n                },\n            }\n        }\n    }\n});\n","import { Mark } from \"@tiptap/core\";\nimport { defaultMarkdownSerializer } from \"prosemirror-markdown\";\n\n\nconst Bold = Mark.create({\n    name: 'bold',\n});\n\nexport default Bold.extend({\n    /**\n     * @return {{markdown: MarkdownMarkSpec}}\n     */\n    addStorage() {\n        return {\n            markdown: {\n                serialize: defaultMarkdownSerializer.marks.strong,\n                parse: {\n                    // handled by markdown-it\n                }\n            },\n        }\n    }\n});\n","import { Mark } from \"@tiptap/core\";\nimport { defaultMarkdownSerializer } from \"prosemirror-markdown\";\n\n\nconst Code = Mark.create({\n    name: 'code',\n});\n\nexport default Code.extend({\n    /**\n     * @return {{markdown: MarkdownMarkSpec}}\n     */\n    addStorage() {\n        return {\n            markdown: {\n                serialize: defaultMarkdownSerializer.marks.code,\n                parse: {\n                    // handled by markdown-it\n                }\n            }\n        }\n    }\n})\n","import { Mark } from \"@tiptap/core\";\nimport { defaultMarkdownSerializer } from \"prosemirror-markdown\";\n\n\nconst Italic = Mark.create({\n    name: 'italic',\n});\n\nexport default Italic.extend({\n    /**\n     * @return {{markdown: MarkdownMarkSpec}}\n     */\n    addStorage() {\n        return {\n            markdown: {\n                serialize: defaultMarkdownSerializer.marks.em,\n                parse: {\n                    // handled by markdown-it\n                }\n            }\n        }\n    }\n})\n","import { Mark } from \"@tiptap/core\";\nimport { defaultMarkdownSerializer } from \"prosemirror-markdown\";\n\n\nconst Link = Mark.create({\n    name: 'link',\n});\n\nexport default Link.extend({\n    /**\n     * @return {{markdown: MarkdownMarkSpec}}\n     */\n    addStorage() {\n        return {\n            markdown: {\n                serialize: defaultMarkdownSerializer.marks.link,\n                parse: {\n                    // handled by markdown-it\n                }\n            }\n        }\n    }\n})\n","import { Mark } from \"@tiptap/core\";\n\n\nconst Strike = Mark.create({\n    name: 'strike',\n});\n\nexport default Strike.extend({\n    /**\n     * @return {{markdown: MarkdownMarkSpec}}\n     */\n    addStorage() {\n        return {\n            markdown: {\n                serialize: {open: '~~', close: '~~', expelEnclosingWhitespace: true},\n                parse: {\n                    // handled by markdown-it\n                },\n            },\n        }\n    }\n});\n","import Blockquote from \"./nodes/blockquote\";\nimport BulletList from \"./nodes/bullet-list\";\nimport CodeBlock from \"./nodes/code-block\";\nimport HardBreak from \"./nodes/hard-break\";\nimport Heading from \"./nodes/heading\";\nimport HorizontalRule from \"./nodes/horizontal-rule\";\nimport HTMLNode from \"./nodes/html\";\nimport Image from \"./nodes/image\";\nimport ListItem from \"./nodes/list-item\";\nimport OrderedList from \"./nodes/ordered-list\";\nimport Paragraph from \"./nodes/paragraph\";\nimport Table from \"./nodes/table\";\nimport TaskItem from \"./nodes/task-item\";\nimport TaskList from \"./nodes/task-list\";\nimport Text from \"./nodes/text\";\n\nimport Bold from \"./marks/bold\";\nimport Code from \"./marks/code\";\nimport HTMLMark from \"./marks/html\";\nimport Italic from \"./marks/italic\";\nimport Link from \"./marks/link\";\nimport Strike from \"./marks/strike\";\n\n\nexport default [\n    Blockquote,\n    BulletList,\n    CodeBlock,\n    HardBreak,\n    Heading,\n    HorizontalRule,\n    HTMLNode,\n    Image,\n    ListItem,\n    OrderedList,\n    Paragraph,\n    Table,\n    TaskItem,\n    TaskList,\n    Text,\n\n    Bold,\n    Code,\n    HTMLMark,\n    Italic,\n    Link,\n    Strike,\n]\n","import markdownExtensions from \"../extensions\";\n\n\nexport function getMarkdownSpec(extension) {\n    const markdownSpec = extension.storage?.markdown;\n    const defaultMarkdownSpec = markdownExtensions.find(e => e.name === extension.name)?.storage.markdown;\n\n    if(markdownSpec || defaultMarkdownSpec) {\n        return {\n            ...defaultMarkdownSpec,\n            ...markdownSpec,\n        };\n    }\n\n    return null;\n}\n","import { MarkdownSerializerState } from './state';\nimport HTMLMark from \"../extensions/marks/html\";\nimport HTMLNode from \"../extensions/nodes/html\";\nimport { getMarkdownSpec } from \"../util/extensions\";\nimport HardBreak from \"../extensions/nodes/hard-break\";\n\n\nexport class MarkdownSerializer {\n    /**\n     * @type {import('@tiptap/core').Editor}\n     */\n    editor = null;\n\n    constructor(editor) {\n        this.editor = editor;\n    }\n\n    serialize(content) {\n        const state = new MarkdownSerializerState(this.nodes, this.marks, {\n            hardBreakNodeName: HardBreak.name,\n        });\n\n        state.renderContent(content);\n\n        return state.out;\n    }\n\n    get nodes() {\n        return {\n            ...Object.fromEntries(\n                Object.keys(this.editor.schema.nodes)\n                    .map(name => [name, this.serializeNode(HTMLNode)])\n            ),\n            ...Object.fromEntries(\n                this.editor.extensionManager.extensions\n                    .filter(extension => extension.type === 'node' && this.serializeNode(extension))\n                    .map(extension => [extension.name, this.serializeNode(extension)])\n                ?? []\n            ),\n        };\n    }\n\n    get marks() {\n        return {\n            ...Object.fromEntries(\n                Object.keys(this.editor.schema.marks)\n                    .map(name => [name, this.serializeMark(HTMLMark)])\n            ),\n            ...Object.fromEntries(\n                this.editor.extensionManager.extensions\n                    .filter(extension => extension.type === 'mark' && this.serializeMark(extension))\n                    .map(extension => [extension.name, this.serializeMark(extension)])\n                ?? []\n            ),\n        };\n    }\n\n    serializeNode(node) {\n        return getMarkdownSpec(node)?.serialize?.bind({ editor: this.editor, options: node.options });\n    }\n\n    serializeMark(mark) {\n        const serialize = getMarkdownSpec(mark)?.serialize;\n        return serialize\n            ? {\n                ...serialize,\n                open: typeof serialize.open === 'function' ? serialize.open.bind({ editor: this.editor, options: mark.options }) : serialize.open,\n                close: typeof serialize.close === 'function' ? serialize.close.bind({ editor: this.editor, options: mark.options }) : serialize.close,\n            }\n            : null\n    }\n}\n\n","import markdownit from \"markdown-it\";\nimport { elementFromString, extractElement, unwrapElement } from \"../util/dom\";\nimport { getMarkdownSpec } from \"../util/extensions\";\n\n\nexport class MarkdownParser {\n    /**\n     * @type {import('@tiptap/core').Editor}\n     */\n    editor = null;\n\n    constructor(editor) {\n        this.editor = editor;\n    }\n\n    parse(content, { inline } = {}) {\n        const {\n            html,\n            linkify,\n            breaks,\n        } = this.editor.storage.markdown.options;\n\n        if(typeof content === 'string') {\n            const renderer = markdownit({\n                html,\n                linkify,\n                breaks,\n            });\n\n            this.editor.extensionManager.extensions.forEach(extension =>\n                getMarkdownSpec(extension)?.parse?.setup?.call({ editor:this.editor, options:extension.options }, renderer)\n            );\n\n            const renderedHTML = renderer.render(content);\n            const element = elementFromString(renderedHTML);\n\n            this.editor.extensionManager.extensions.forEach(extension =>\n                getMarkdownSpec(extension)?.parse?.updateDOM?.call({ editor:this.editor, options:extension.options }, element)\n            );\n\n            this.normalizeDOM(element, { inline, content });\n\n            return element.innerHTML;\n        }\n\n        return content;\n    }\n\n    normalizeDOM(node, { inline, content } = {}) {\n        this.normalizeBlocks(node);\n\n        if(inline) {\n            this.normalizeInline(node, content);\n        }\n\n        return node;\n    }\n\n    normalizeBlocks(node) {\n        const blocks = Object.values(this.editor.schema.nodes)\n            .filter(node => node.isBlock);\n\n        const selector = blocks\n            .map(block => block.spec.parseDOM?.map(spec => spec.tag))\n            .flat()\n            .filter(Boolean)\n            .join(',');\n\n        if(!selector) {\n            return;\n        }\n\n        [...node.querySelectorAll(selector)].forEach(el => {\n            if(el.parentElement.matches('p')) {\n                extractElement(el);\n            }\n        });\n    }\n\n    normalizeInline(node, content) {\n        if(node.firstElementChild?.matches('p')) {\n            const firstParagraph = node.firstElementChild;\n            const { nextSibling, nextElementSibling } = firstParagraph;\n            const startSpaces = content.match(/^\\s+/)?.[0] ?? '';\n            const endSpaces = !nextElementSibling\n                ? content.match(/\\s+$/)?.[0] ?? ''\n                : '';\n\n            if(nextSibling?.nodeType === Node.TEXT_NODE) {\n                nextSibling.textContent = nextSibling.textContent.replace(/^\\n/, '');\n            }\n\n            if(content.match(/^\\n\\n/)) {\n                firstParagraph.innerHTML = `${firstParagraph.innerHTML}${endSpaces}`;\n                return;\n            }\n\n            unwrapElement(firstParagraph);\n\n            node.innerHTML = `${startSpaces}${node.innerHTML}${endSpaces}`;\n        }\n    }\n}\n\n","import { Extension } from \"@tiptap/core\";\nimport { Plugin, PluginKey } from '@tiptap/pm/state';\nimport { DOMParser } from '@tiptap/pm/model';\nimport { elementFromString } from \"../../util/dom\";\n\nexport const MarkdownClipboard = Extension.create({\n    name: 'markdownClipboard',\n    addOptions() {\n        return {\n            transformPastedText: false,\n            transformCopiedText: false,\n        }\n    },\n    addProseMirrorPlugins() {\n        return [\n            new Plugin({\n                key: new PluginKey('markdownClipboard'),\n                props: {\n                    clipboardTextParser: (text, context, plainText) => {\n                        if(plainText || !this.options.transformPastedText) {\n                            return null; // pasting with shift key prevents formatting\n                        }\n                        const parsed = this.editor.storage.markdown.parser.parse(text, { inline: true });\n                        return DOMParser.fromSchema(this.editor.schema)\n                            .parseSlice(elementFromString(parsed), { preserveWhitespace: true });\n                    },\n                    /**\n                     * @param {import('prosemirror-model').Slice} slice\n                     */\n                    clipboardTextSerializer: (slice) => {\n                        if(!this.options.transformCopiedText) {\n                            return null;\n                        }\n                        return this.editor.storage.markdown.serializer.serialize(slice.content);\n                    },\n                },\n            })\n        ]\n    }\n})\n","import { Extension, extensions } from '@tiptap/core';\nimport { MarkdownTightLists } from \"./extensions/tiptap/tight-lists\";\nimport { MarkdownSerializer } from \"./serialize/MarkdownSerializer\";\nimport { MarkdownParser } from \"./parse/MarkdownParser\";\nimport { MarkdownClipboard } from \"./extensions/tiptap/clipboard\";\n\nexport const Markdown = Extension.create({\n    name: 'markdown',\n    priority: 50,\n    addOptions() {\n        return {\n            html: true,\n            tightLists: true,\n            tightListClass: 'tight',\n            bulletListMarker: '-',\n            linkify: false,\n            breaks: false,\n            transformPastedText: false,\n            transformCopiedText: false,\n        }\n    },\n    addCommands() {\n        const commands = extensions.Commands.config.addCommands();\n        return {\n            setContent: (content, emitUpdate, parseOptions) => (props) => {\n                return commands.setContent(\n                    props.editor.storage.markdown.parser.parse(content),\n                    emitUpdate,\n                    parseOptions\n                )(props);\n            },\n            insertContentAt: (range, content, options) => (props) => {\n                return commands.insertContentAt(\n                    range,\n                    props.editor.storage.markdown.parser.parse(content, { inline: true }),\n                    options\n                )(props);\n            },\n        }\n    },\n    onBeforeCreate() {\n        this.editor.storage.markdown = {\n            options: { ...this.options },\n            parser: new MarkdownParser(this.editor),\n            serializer: new MarkdownSerializer(this.editor),\n            getMarkdown: () => {\n                return this.editor.storage.markdown.serializer.serialize(this.editor.state.doc);\n            },\n        }\n        this.editor.options.initialContent = this.editor.options.content;\n        this.editor.options.content = this.editor.storage.markdown.parser.parse(this.editor.options.content);\n    },\n    onCreate() {\n        this.editor.options.content = this.editor.options.initialContent;\n        delete this.editor.options.initialContent;\n    },\n    addStorage() {\n        return {\n            /// storage will be defined in onBeforeCreate() to prevent initial object overriding\n        }\n    },\n    addExtensions() {\n        return [\n            MarkdownTightLists.configure({\n                tight: this.options.tightLists,\n                tightClass: this.options.tightListClass,\n            }),\n            MarkdownClipboard.configure({\n                transformPastedText: this.options.transformPastedText,\n                transformCopiedText: this.options.transformCopiedText,\n            }),\n        ]\n    },\n});\n"],"names":["MarkdownTightLists","Extension","create","name","addOptions","tight","tightClass","listTypes","addGlobalAttributes","_this","types","options","attributes","parseHTML","element","getAttribute","querySelector","renderHTML","addCommands","_this2","toggleTight","arguments","length","undefined","_ref","editor","commands","isActive","attrs","getAttributes","updateAttributes","some","scanDelims","text","pos","state","markdownit","inline","State","shiftDelim","delim","start","offset","res","substring","trimStart","from","to","can_open","trimEnd","can_close","trimInline","MarkdownSerializerState","_BaseMarkdownSerializ","_inherits","_super","_createSuper","nodes","marks","_classCallCheck","call","inlines","_createClass","key","value","render","node","parent","index","_get","_getPrototypeOf","prototype","top","end","_this$normalizeInline","normalizeInline","delimiter","out","pop","markString","mark","open","info","type","expelEnclosingWhitespace","push","_objectSpread","charAt","match","BaseMarkdownSerializerState","Mark","addStorage","markdown","serialize","_getMarkTags$","_getMarkTags","storage","html","console","warn","concat","getMarkTags","close","_getMarkTags$2","_getMarkTags2","parse","schema","getHTMLFromFragment","Fragment","elementFromString","wrappedValue","window","DOMParser","parseFromString","body","escapeHTML","replace","extractElement","parentElement","prepend","cloneNode","firstChild","appendChild","childNodes","insertBefore","remove","unwrapElement","parentNode","removeChild","Node","write","serializeHTML","isBlock","closeBlock","topNodeType","formatBlock","dom","firstElementChild","innerHTML","trim","outerHTML","Blockquote","extend","defaultMarkdownSerializer","blockquote","BulletList","renderList","bulletListMarker","CodeBlock","language","textContent","ensureNewLine","setup","_this$options$languag","set","langPrefix","languageClassPrefix","updateDOM","HardBreak","hard_break","Heading","heading","HorizontalRule","horizontal_rule","Image","image","ListItem","list_item","OrderedList","ordered_list","Paragraph","paragraph","_node$content$content","_node$content","content","Table","isMarkdownSerializable","HTMLNode","forEach","row","p","i","col","j","cellContent","renderInline","delimiterRow","Array","childCount","map","join","hasSpan","colspan","rowspan","rows","firstRow","bodyRows","slice","cell","TaskItem","check","checked","renderContent","_toConsumableArray","querySelectorAll","item","input","setAttribute","TaskList","use","taskListPlugin","list","Text","Bold","strong","Code","code","Italic","em","Link","link","Strike","HTMLMark","getMarkdownSpec","extension","_extension$storage","_markdownExtensions$f","markdownSpec","defaultMarkdownSpec","markdownExtensions","find","e","MarkdownSerializer","_defineProperty","hardBreakNodeName","get","_this$editor$extensio","Object","fromEntries","keys","serializeNode","extensionManager","extensions","filter","_this$editor$extensio2","serializeMark","_getMarkdownSpec","_getMarkdownSpec$seri","bind","_getMarkdownSpec2","MarkdownParser","_this$editor$storage$","linkify","breaks","renderer","_getMarkdownSpec$pars","_getMarkdownSpec$pars2","renderedHTML","_getMarkdownSpec2$par","_getMarkdownSpec2$par2","normalizeDOM","_ref2","normalizeBlocks","blocks","values","selector","block","_block$spec$parseDOM","spec","parseDOM","tag","flat","Boolean","el","matches","_node$firstElementChi","_content$match$","_content$match","_content$match$2","_content$match2","firstParagraph","nextSibling","nextElementSibling","startSpaces","endSpaces","nodeType","TEXT_NODE","MarkdownClipboard","transformPastedText","transformCopiedText","addProseMirrorPlugins","Plugin","PluginKey","props","clipboardTextParser","context","plainText","parsed","parser","fromSchema","parseSlice","preserveWhitespace","clipboardTextSerializer","serializer","Markdown","priority","tightLists","tightListClass","Commands","config","setContent","emitUpdate","parseOptions","insertContentAt","range","onBeforeCreate","getMarkdown","doc","initialContent","onCreate","addExtensions","configure"],"mappings":"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"}